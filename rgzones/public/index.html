<!doctype html>
        <html lang="en">
        <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>Protected iframe</title>
        <style>
          html,body { height:100%; margin:0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; }
          .iframe-wrap { position:relative; width:100%; height:100vh; }
          iframe#targetFrame { width:100%; height:100%; border:0; display:block; }
          .overlay {
            position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
            background: rgba(0,0,0,0.5); z-index:10; color:#fff;
          }
          .card {
            background: #0f1724; padding:20px; border-radius:10px; min-width:300px; max-width:420px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.6);
          }
          label { display:block; margin-bottom:6px; font-size:14px; }
          input[type="password"] { width:100%; padding:10px; margin-bottom:12px; border-radius:6px; border:1px solid #334155; background:#071226; color:#fff; }
          button { padding:10px 14px; border-radius:6px; border:0; background:#0ea5a4; color:#042; font-weight:600; cursor:pointer; }
          .hint { font-size:13px; opacity:0.85; margin-top:8px; color:#cbd5e1; }
          .error { color:#ffb4b4; margin-top:8px; font-size:13px; display:none; }
        </style>
        </head>
        <body>
        <div class="iframe-wrap">
          <iframe id="targetFrame" src="about:blank" title="Protected iframe"></iframe>

          <div class="overlay" id="overlay">
            <div class="card" role="dialog" aria-modal="true" aria-label="Password required">
              <div style="font-size:18px; font-weight:700; margin-bottom:6px;">Protected content</div>
              <div style="font-size:13px; margin-bottom:12px;">Enter password to load the content.</div>

              <label for="pw">Password</label>
              <input id="pw" type="password" autocomplete="current-password" inputmode="text" />
              <div style="display:flex; gap:8px; align-items:center;">
                <button id="unlock">Unlock</button>
                <button id="reveal" type="button" style="background:#334155;color:#fff;">Show</button>
              </div>

              <div class="error" id="error">Incorrect password</div>
              <div class="hint">This is client-side gating. Not secure against a determined user.</div>
            </div>
          </div>
        </div>

        <script>
        /* Embedded values (safe JS literals) */
        const expectedHash = "fcf730b6d95236ecd3c9fc2d92d7b6b2bb061514961aec041d6c7a7192f592e4"; // SHA-256 hex (lowercase)
        const targetUrl = "/Users/newbrie/Sites/UNITED_KINGDOM/ENGLAND/SURREY/REIGATE/WARDS/MEADVALE_AND_ST_JOHNS/MEADVALE_AND_ST_JOHNS-WALKS.html";

        function hexFromBuffer(buf) {
          const arr = new Uint8Array(buf);
          return Array.from(arr).map(b => b.toString(16).padStart(2, '0')).join('');
        }

        async function computeSHA256Hex(text) {
          if (!window.crypto || !window.crypto.subtle) {
            throw new Error('Web Crypto API not available');
          }
          const enc = new TextEncoder();
          const data = enc.encode(text);
          const hashBuf = await crypto.subtle.digest('SHA-256', data);
          return hexFromBuffer(hashBuf);
        }

        function showError(msg) {
          const el = document.getElementById('error');
          el.textContent = msg;
          el.style.display = 'block';
        }

        document.getElementById('unlock').addEventListener('click', async () => {
          const pw = document.getElementById('pw').value || '';
          document.getElementById('error').style.display = 'none';

          try {
            const derived = await computeSHA256Hex(pw);
            // debug: console.log('derived', derived, 'expected', expectedHash);
            if (derived === expectedHash) {
              // success
              document.getElementById('targetFrame').src = targetUrl;
              document.getElementById('overlay').style.display = 'none';
              // clear password from input
              document.getElementById('pw').value = '';
            } else {
              showError("Incorrect password");
            }
          } catch (e) {
            console.error('Error computing SHA-256', e);
            showError('Error verifying password (see console)');
          }
        });

        document.getElementById('reveal').addEventListener('click', () => {
          const pwEl = document.getElementById('pw');
          pwEl.type = pwEl.type === 'password' ? 'text' : 'password';
        });

        // Optional: allow Enter key to submit
        document.getElementById('pw').addEventListener('keydown', (ev) => {
          if (ev.key === 'Enter') {
            ev.preventDefault();
            document.getElementById('unlock').click();
          }
        });
        </script>
        </body>
        </html>
        